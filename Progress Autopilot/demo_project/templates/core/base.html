<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Progress Autopilot{% endblock %}</title>
  <link rel="stylesheet" href="/static/css/style.css">
  <style>
    /* Additional animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .animated-in {
      animation: fadeInUp 0.5s ease-out;
    }

    .bounce-in {
      animation: bounce 0.6s ease-out;
    }

    /* Theme toggle styles */
    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.25rem;
      padding: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      transition: all 0.3s ease;
      color: var(--text-primary);
    }

    .theme-toggle:hover {
      background: var(--bg-primary);
    }

    @media (prefers-reduced-motion: reduce) {
      .theme-toggle {
        transition: none;
      }
    }
  </style>
</head>
<body>
  <header class="top">
    <a class="brand" href="{% url 'dashboard' %}">âœ“ Progress Autopilot</a>
    <nav>
      {% if user.is_authenticated %}
        <a href="{% url 'dashboard' %}">Dashboard</a>
        <a href="{% url 'goal_list' %}">Goals</a>
        <a href="{% url 'weekly_review' %}">Weekly Review</a>
        <a href="{% url 'profile' %}">Profile</a>
        <a href="{% url 'logout' %}">Logout</a>
      {% else %}
        <a href="{% url 'login' %}">Login</a>
        <a href="{% url 'signup' %}">Sign up</a>
      {% endif %}
    </nav>
  </header>
  
  <main class="container">
    {% if messages %}
      <div class="section">
        {% for message in messages %}
          <div class="flash {% if message.tags %}{{ message.tags }}{% endif %}" role="alert">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
    
    {% block content %}{% endblock %}
  </main>

  <footer style="text-align: center; padding: 2rem; color: var(--text-muted); border-top: 1px solid var(--border-color); margin-top: 3rem;">
    <p>&copy; 2024 Progress Autopilot. Built with intention.</p>
  </footer>

  <script>
    // Smooth page transitions
    document.addEventListener('DOMContentLoaded', function() {
      // Add animation to cards on load
      const cards = document.querySelectorAll('.card');
      cards.forEach((card, index) => {
        card.style.animation = `fadeInUp 0.5s ease-out ${index * 0.1}s both`;
      });

      // Add ripple effect to buttons
      const buttons = document.querySelectorAll('.btn');
      buttons.forEach(button => {
        button.addEventListener('click', function(e) {
          const ripple = document.createElement('span');
          const rect = this.getBoundingClientRect();
          const size = Math.max(rect.width, rect.height);
          const x = e.clientX - rect.left - size / 2;
          const y = e.clientY - rect.top - size / 2;

          ripple.style.width = ripple.style.height = size + 'px';
          ripple.style.left = x + 'px';
          ripple.style.top = y + 'px';
          ripple.classList.add('ripple');

          this.appendChild(ripple);

          setTimeout(() => ripple.remove(), 600);
        });
      });

      // Form input focus effects
      const inputs = document.querySelectorAll('input, textarea, select');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          this.parentElement.style.animation = 'fadeInUp 0.3s ease';
        });
      });
    });

    // Detect user preference for dark mode
    function initTheme() {
      const isDarkMode = localStorage.getItem('darkMode') === 'true' || 
                         window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (isDarkMode) {
        document.documentElement.style.colorScheme = 'dark';
      }
    }

    initTheme();
  </script>

  <style>
    .ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      transform: scale(0);
      animation: ripple-animation 0.6s ease-out;
      pointer-events: none;
    }

    @keyframes ripple-animation {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }
  </style>
</body>
</html>

{% extends 'core/base.html' %}
{% block title %}Weekly Review - Progress Autopilot{% endblock %}
{% block content %}

<div style="margin-bottom: 2rem;">
  <h1>ğŸ“Š Weekly Review</h1>
  <p style="color: var(--text-muted);">Week of {{ start }}</p>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
  <!-- Total Actions Card -->
  <div class="card" style="text-align: center;">
    <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 0.5rem;">Total Actions</p>
    <p style="font-size: 2.5rem; font-weight: 700; background: linear-gradient(135deg, var(--info) 0%, #2563eb 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
      {{ stats.total }}
    </p>
  </div>

  <!-- Completed Card -->
  <div class="card" style="text-align: center;">
    <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 0.5rem;">Completed</p>
    <p style="font-size: 2.5rem; font-weight: 700; background: linear-gradient(135deg, var(--success) 0%, #059669 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
      {{ stats.completed }}
    </p>
  </div>

  <!-- Failed Card -->
  <div class="card" style="text-align: center;">
    <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 0.5rem;">Failed</p>
    <p style="font-size: 2.5rem; font-weight: 700; background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
      {{ stats.failed }}
    </p>
  </div>

  <!-- Success Rate Card -->
  <div class="card" style="text-align: center;">
    <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 0.5rem;">Success Rate</p>
    <p style="font-size: 2.5rem; font-weight: 700; background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
      {{ stats.success_rate }}%
    </p>
  </div>
</div>

<!-- Difficulty Analysis -->
<div class="row">
  <div class="card">
    <h3 style="margin-bottom: 1.5rem;">ğŸ’ª Difficulty Analysis</h3>
    
    <div style="display: flex; flex-direction: column; gap: 1rem;">
      <div>
        <p style="color: var(--text-muted); margin-bottom: 0.5rem;">Most Challenging</p>
        {% if stats.hardest %}
          <div style="padding: 1rem; background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(239, 68, 68, 0.05) 100%); border-left: 4px solid var(--danger); border-radius: 8px;">
            <p style="margin: 0; font-weight: 600; color: var(--text-primary);">{{ stats.hardest.title }}</p>
            <p style="margin: 0.5rem 0 0 0; font-size: 0.85rem; color: var(--text-muted);">Difficulty: Level {{ stats.hardest.difficulty }}</p>
          </div>
        {% else %}
          <p style="color: var(--text-muted);">No data yet</p>
        {% endif %}
      </div>

      <div style="border-bottom: 1px solid var(--border-color);"></div>

      <div>
        <p style="color: var(--text-muted); margin-bottom: 0.5rem;">Easiest to Complete</p>
        {% if stats.easiest %}
          <div style="padding: 1rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%); border-left: 4px solid var(--success); border-radius: 8px;">
            <p style="margin: 0; font-weight: 600; color: var(--text-primary);">{{ stats.easiest.title }}</p>
            <p style="margin: 0.5rem 0 0 0; font-size: 0.85rem; color: var(--text-muted);">Difficulty: Level {{ stats.easiest.difficulty }}</p>
          </div>
        {% else %}
          <p style="color: var(--text-muted);">No data yet</p>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Insights Card -->
  <aside>
    <div class="card accent">
      <h3 style="margin-bottom: 1.5rem;">ğŸ¯ Insights</h3>
      <div style="display: flex; flex-direction: column; gap: 1rem;">
        <div>
          <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 0.5rem;">Consistency</p>
          <div style="width: 100%; height: 8px; background: var(--border-color); border-radius: 4px; overflow: hidden;">
            <div style="height: 100%; width: {{ success }}%; background: linear-gradient(90deg, var(--accent-primary) 0%, var(--accent-secondary) 100%); transition: width 0.5s ease;"></div>
          </div>
        </div>

        <div style="border-bottom: 1px solid rgba(99, 102, 241, 0.2);"></div>

        <div style="padding: 1rem; background: var(--bg-secondary); border-radius: 8px; text-align: center;">
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Performance Rating</p>
          <p style="font-size: 1.5rem;">
            {% if success >= 80 %}â­â­â­â­â­
            {% elif success >= 60 %}â­â­â­â­
            {% elif success >= 40 %}â­â­â­
            {% elif success >= 20 %}â­â­
            {% else %}â­
            {% endif %}
          </p>
        </div>
      </div>
    </div>

    <div class="card">
      <p style="text-align: center; color: var(--text-muted); font-size: 0.9rem;">
        Great week! Keep up the momentum ğŸš€
      </p>
    </div>
  </aside>
</div>

<div class="card text-center" style="margin-top: 2rem;">
  <a href="{% url 'dashboard' %}" class="btn">â† Back to Dashboard</a>
</div>

{% endblock %}
